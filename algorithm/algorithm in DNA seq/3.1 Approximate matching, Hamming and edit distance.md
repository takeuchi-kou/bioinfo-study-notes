# Approximate matching, Hamming and edit distance

## approximate matching

之前我们提过的算法，都是精确匹配的算法。

![image-20211228193757777](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228193757777.png)

但是事实上，在DNA序列比对过程中，我们不想让它进行精确比对，而是近似匹配。DNA序列与参考序列不可能完全精确匹配的原因有2：

1. 测序过程中不可避免的错误
2. 自然的基因变异

### 造成匹配错误的类型

- 错配

![image-20211228194152232](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228194152232.png)

- 插入

![image-20211228194215593](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228194215593.png)

- 删失

![image-20211228194253673](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228194253673.png)

### 衡量DNA seq与参考基因组的相差程度

- Hamming distance

为了让XY序列完全一致，所需要进行的最小的替换数量

![image-20211228194620175](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228194620175.png)

- Edit distance

为了让XY序列完全一致，所需要进行的最小的**编辑（EDIT）**数量。

比起hamming distance，除了替换还能进行插入和删除，另外，XY的长度不一定需要一致

![image-20211228194906829](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228194906829.png)

## Hamming distance

### 修改naive exact matching，使之允许Hamming distance

修改前

![image-20211228195305962](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228195305962.png)

修改后

![image-20211228195342908](https://gitee.com/joy_thestraydog/typora/raw/master/img/image-20211228195342908.png)

在inner loop发生mismatch之后，不立即break跳出循环，而是把mismatch的数量+1，直到超过我们设定的上限。
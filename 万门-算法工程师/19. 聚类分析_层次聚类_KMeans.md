# 聚类分析

## 定义

按照反映对象特征的数据把对象进行分类，叫做聚类分析。

对象分为变量和样本。

变量：根据样本对各个变量进行分类，称为R型聚类；

样本：根据变量对各个样本进行分类，，称为Q型聚类。

变量的相似性称为 相似系数；

样本的相似性称为 距离

![image-20220120101208587](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220120101208587.png)

### 样本间距离的计算方法

![image-20220120101246206](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220120101246206.png)

### 变量间相似系数的计算

![image-20220120101353956](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220120101353956.png)

# 层次聚类(系统聚类)

事先不确定分多少类，而是每一个对象当做一类，然后一层层进行聚类。

合并法/分解法

1. 把每一个样本作为一类，n个样本分成n类；
2. 按照某种方法度量样本之间的距离，并将距离最近的两个样本点合为一类；
3. 再计算新产生的类别与其他类别之间的距离，再将两个距离最近的类别合为一类，如此反复。
4. 以上为合并法，而分解法则是与之相反的过程

### 类间距离的计算方法

离差平方和最常用，类别之内距离小，类别之间距离大

![image-20220120102252156](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220120102252156.png)

## K-means聚类

### 基本过程

1. 确定K，也就是最后我们需要多少个类别
2. 确定K个类别的初始聚类中心(任意选择K个点)
3. 依次计算每个样本到K个聚类中心的欧氏距离，并根据最近原则，将所有样本分到事先确定的K个类别中。
4. 根据所分成的K个类别，计算出各个类别中每个变量的均值，并以均值作为新的K个类别中心；根据新的类别中心重新计算每个样本到新中心的距离，并重新进行分类
5. 重复迭代，直到达到终止条件：（1， 迭代次数达到事先指定的最大次数；2，新确立的聚类中心点与上一次迭代形成的中心点的最大偏移量小于指定量）

最终得到的可能不是真实存在的点。

### 与层次聚类比较

需要提前确定K；

运算量小很多；

输出结果类似
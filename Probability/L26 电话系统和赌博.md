![image-20220102074443773](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220102074443773.png)

# 1. 复习

recurrent

transient

steady state

recurrent class

periodic

converge probability 

balance equation 

我们已经讲了在单一class中steady state 的概率计算方法，这一节课我们将会涉及到一个涉及2个class的系统，在transient state开始时的steady probability。

![image-20220102080458273](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220102080458273.png)

## 马尔科夫链的收敛时间与混合时间

对于如图的马尔科夫系统，多少步以后我们能把n称作是"足够大",从而获得极限性质呢？

1. 我们可以进行混合时间模拟(mixing time)，也就是把n=1开始的转变概率一个一个画出在坐标系中，横轴为n纵轴为转换概率；然后观察n到几的时候收敛得比较好。事实上对于这个例子，n=5时已经获得了2位正确小数，n=10时已经获得了5位正确小数。观察混合时间图像可以发现，其曲线的下降是指数级的速度。
2. 可以从数量级角度考虑。当1和2互相转变的概率为0.5和0.2，而n等于100步时，我们很难判断到底停留在哪个state，也就是说此时系统已经获得了较好的随机性；而如果互相转变的概率为0.0001和0.0002的话，n=100时，很有可能还没有出现第一次转变，此时我们知道n肯定不足够大。
3. 可以从理论基础考虑，有专门的系数c用于计算收敛速率

![image-20220102100231654](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220102100231654.png)

# 2. 连续马尔科夫链的近似

## phone system(Erlang)

假设我们要设计一个电话系统，电话线的数目能够让村内所有人都顺利向外打电话不占线，但电话线数目又不会多到浪费。如何设计电话线的数量？

- 假设：

村民拿起电话的概率是一个泊松分布，其速率为$\lambda$；

每通电话持续的时间是指数分布，参数为$\mu$(其实更符合实际情况狂的是参数为2 2/3de Erlang 分布，但这里为保持计算简单，就用指数分布)；

- 观察

这里拿起电话和挂掉电话的概率是互相独立的并且无记忆性，看起来我们处于一个连续的马尔科夫系统中。但是我们并没有对连续状态的马尔科夫系统进行过研究。所以我们还是用小间隔的离散状态去近似这种连续系统。假设每个小的time slot长度为$\delta$。

- 对于每个time slot $\delta$来说：

即产生一通电话的概率，近似为$\lambda\delta$；、

如果我们目前有i个正在通话，则结束一通电话的概率近似为$i\mu\delta$

![image-20220102105047474](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220102105047474.png)

- 建立模型

对于这样一个 系统，当前状态的一个最重要参数就是当前占线/通话的数量。

对于马尔科夫链来说，这个系统的state从通话数=0开始，到最大通话数B结束

而且我们看出，这不仅是一个马尔科夫模型，更是一个b-d process，

- 参数之间的关系

根据balance equation，状态i和i-1之间的转换概率：

从i-1向i，即通话数增大的概率为$\pi_{i-1}\lambda\delta$；

从i向i-1，级从通话数向少转换的概率为$\pi_ii\mu\delta$。

这两者应该是相同的，左右消去，得到新的equation表示$\pi$之间的关系；

而我们知道一共有B个state，就可以求出每个state的概率。

最终我们得到$\pi_0$乃至于每个state的概率，知道它是一个关于B、$\lambda和\mu$的函数。

- 可以回答的问题

根据这个公式，我们可以算出任意给定的time slot之后，我们的系统有几个线路占线；

根据频率解释，总共有多长时间我们的系统会处于占线某个比例以上

- 题目问题

题目希望所有所有线路都繁忙的概率比较小，也就是希望一个随机变量一步到达Bstate的概率比较小。

换句话说，对于给定的$\lambda \mu$，找到一个B使得$\pi_B$比较小。

我们假设$\lambda=30$，也就是说每分钟产生30通电话；$\mu=1/3$，即一通电话平均持续3min；

- 如何解答

因为每分钟的电话数为30通，一通电话平均持续3min，所以平均下来有90个线路会一直处于繁忙中。但是我们不希望有人想打电话的时候会占线，所以电话线路必须比90高一些，那么高多少呢？

这里我们需要定义一下，占线率多少能符合我们的需求。也就是，每有一通电话开始打，多少概率是占线的？如果我们希望占线率<1%，那么就定义$\pi_B<1%$，这样一来就可以求出B值了。

![image-20220102133259617](https://gitee.com/joy_thestraydog/typora1.0/raw/master/image-20220102133259617.png)